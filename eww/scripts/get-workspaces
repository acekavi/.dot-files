#!/bin/bash

# Get workspace information for Hyprland
# This script outputs JSON for eww to parse

# Check if Hyprland is running
if ! pgrep -x "Hyprland" > /dev/null; then
    echo "[]"
    exit 0
fi

# Get workspace data from hyprctl
workspaces=$(hyprctl workspaces -j 2>/dev/null)
active_workspace=$(hyprctl activeworkspace -j 2>/dev/null | jq -r '.id' 2>/dev/null)

if [ -z "$workspaces" ] || [ "$workspaces" = "null" ]; then
    echo "[]"
    exit 0
fi

# Process the workspace data
echo "$workspaces" | jq --argjson active "$active_workspace" '
map({
    name: .id,
    windows: .windows,
    focused: (.id == $active),
    visible: (.id == $active),
    urgent: false,
    output: .monitor
}) | sort_by(.name)'
